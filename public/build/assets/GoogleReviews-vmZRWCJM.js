import{r,j as e}from"./app-VOhr-F7S.js";import{B as l}from"./button-DB1vS6hQ.js";import{C as m,b as x,c as h,a as j}from"./card-CauYnrHC.js";import{S as i}from"./star-CbM6CTsu.js";import{M as v}from"./message-square-Bg0Q6Utl.js";import{c as G}from"./createLucideIcon-XyfHAKeK.js";const E=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],n=G("ExternalLink",E);function A({showLeaveReviewButton:c=!0,maxReviews:o=3}){const[t,y]=r.useState(null),[b,_]=r.useState(!0),[u,R]=r.useState(null),p=()=>{const s=t?.review_url||"";return typeof s=="string"&&s.trim().length>0?s:""},f=()=>{const s=t?.maps_url||"";return typeof s=="string"&&s.trim().length>0?s:""};r.useEffect(()=>{(async()=>{try{const a=await fetch("/api/google-reviews");if(!a.ok)throw new Error("Failed to fetch reviews");const C=await a.json();y(C)}catch(a){console.error("Error fetching Google Reviews:",a),R("Unable to load reviews at this time")}finally{_(!1)}})()},[]);const g=s=>e.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(a=>e.jsx(i,{className:`h-4 w-4 ${a<=s?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},a))}),d=()=>{const s=p();s&&window.open(s,"_blank")},k=()=>{const s=f();s&&window.open(s,"_blank")};if(b)return e.jsxs(m,{children:[e.jsx(x,{children:e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(i,{className:"h-5 w-5 text-yellow-400"}),"Google Reviews"]})}),e.jsx(j,{children:e.jsx("div",{className:"space-y-4",children:[...Array(o)].map((s,a)=>e.jsxs("div",{className:"animate-pulse",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-300 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-4 bg-gray-300 rounded w-24 mb-1"}),e.jsx("div",{className:"h-3 bg-gray-300 rounded w-16"})]})]}),e.jsx("div",{className:"h-3 bg-gray-300 rounded w-full mb-1"}),e.jsx("div",{className:"h-3 bg-gray-300 rounded w-3/4"})]},a))})})]});if(u||!t)return e.jsxs(m,{children:[e.jsx(x,{children:e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(i,{className:"h-5 w-5 text-yellow-400"}),"Google Reviews"]})}),e.jsx(j,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(v,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:u||"Reviews temporarily unavailable"}),c&&e.jsxs(l,{onClick:d,disabled:!p(),children:[e.jsx(n,{className:"h-4 w-4 mr-2"}),"Leave a Google Review"]})]})})]});const w=t.reviews.slice(0,o),N=t.rating;return e.jsxs(m,{children:[e.jsx(x,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(i,{className:"h-5 w-5 text-yellow-400"}),"Google Reviews"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl font-bold",children:N}),e.jsxs("div",{className:"flex flex-col",children:[g(Math.round(N)),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[t.total_reviews," reviews"]})]})]})]})}),e.jsx(j,{className:"space-y-4",children:w.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(v,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No reviews yet"}),c&&e.jsxs(l,{onClick:d,className:"mt-4",children:[e.jsx(n,{className:"h-4 w-4 mr-2"}),"Be the first to review!"]})]}):e.jsxs(e.Fragment,{children:[w.map((s,a)=>e.jsx("div",{className:"border-b last:border-b-0 pb-4 last:pb-0",children:e.jsxs("div",{className:"flex items-start gap-3",children:[s.profile_photo_url&&e.jsx("img",{src:s.profile_photo_url,alt:s.author_name,className:"w-8 h-8 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h4",{className:"font-medium",children:s.author_name}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s.relative_time_description})]}),g(s.rating),e.jsx("p",{className:"text-sm text-gray-700 mt-2",children:s.text})]})]})},a)),t.total_reviews>o&&e.jsxs(l,{variant:"outline",onClick:k,className:"w-full",disabled:!f(),children:[e.jsx(n,{className:"h-4 w-4 mr-2"}),"View all ",t.total_reviews," reviews on Google"]}),c&&e.jsxs("div",{className:"pt-4 border-t",children:[e.jsxs(l,{onClick:d,className:"w-full",children:[e.jsx(n,{className:"h-4 w-4 mr-2"}),"Leave a Google Review"]}),e.jsx("p",{className:"text-xs text-muted-foreground text-center mt-2",children:"Share your experience on Google to help others"})]})]})})]})}export{A as G};
